name: PlatformIO CI/CD

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 10

    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name:
        run: |
          OWNER="MakerbaseMoon"
          REPO="cleaner-4th-website"
          RELEASE_URL=$(curl -s "https://api.github.com/repos/${OWNER}/${REPO}/releases/latest" | grep -o '"browser_download_url": "[^"]*website\.h"' | cut -d'"' -f4)
          echo ${RELEASE_URL} 
          wget -P include/components/website.h  ${RELEASE_URL} 
          ls -al
          ls -al include/components/